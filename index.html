
<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>Dealer.com Website Integration API Reference</title>

    <style>
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight .gh {
  color: #999999;
}
.highlight .sr {
  color: #f6aa11;
}
.highlight .go {
  color: #888888;
}
.highlight .gp {
  color: #555555;
}
.highlight .gs {
}
.highlight .gu {
  color: #aaaaaa;
}
.highlight .nb {
  color: #f6aa11;
}
.highlight .cm {
  color: #75715e;
}
.highlight .cp {
  color: #75715e;
}
.highlight .c1 {
  color: #75715e;
}
.highlight .cs {
  color: #75715e;
}
.highlight .c, .highlight .cd {
  color: #75715e;
}
.highlight .err {
  color: #960050;
}
.highlight .gr {
  color: #960050;
}
.highlight .gt {
  color: #960050;
}
.highlight .gd {
  color: #49483e;
}
.highlight .gi {
  color: #49483e;
}
.highlight .ge {
  color: #49483e;
}
.highlight .kc {
  color: #66d9ef;
}
.highlight .kd {
  color: #66d9ef;
}
.highlight .kr {
  color: #66d9ef;
}
.highlight .no {
  color: #66d9ef;
}
.highlight .kt {
  color: #66d9ef;
}
.highlight .mf {
  color: #ae81ff;
}
.highlight .mh {
  color: #ae81ff;
}
.highlight .il {
  color: #ae81ff;
}
.highlight .mi {
  color: #ae81ff;
}
.highlight .mo {
  color: #ae81ff;
}
.highlight .m, .highlight .mb, .highlight .mx {
  color: #ae81ff;
}
.highlight .sc {
  color: #ae81ff;
}
.highlight .se {
  color: #ae81ff;
}
.highlight .ss {
  color: #ae81ff;
}
.highlight .sd {
  color: #e6db74;
}
.highlight .s2 {
  color: #e6db74;
}
.highlight .sb {
  color: #e6db74;
}
.highlight .sh {
  color: #e6db74;
}
.highlight .si {
  color: #e6db74;
}
.highlight .sx {
  color: #e6db74;
}
.highlight .s1 {
  color: #e6db74;
}
.highlight .s {
  color: #e6db74;
}
.highlight .na {
  color: #a6e22e;
}
.highlight .nc {
  color: #a6e22e;
}
.highlight .nd {
  color: #a6e22e;
}
.highlight .ne {
  color: #a6e22e;
}
.highlight .nf {
  color: #a6e22e;
}
.highlight .vc {
  color: #ffffff;
}
.highlight .nn {
  color: #ffffff;
}
.highlight .nl {
  color: #ffffff;
}
.highlight .ni {
  color: #ffffff;
}
.highlight .bp {
  color: #ffffff;
}
.highlight .vg {
  color: #ffffff;
}
.highlight .vi {
  color: #ffffff;
}
.highlight .nv {
  color: #ffffff;
}
.highlight .w {
  color: #ffffff;
}
.highlight {
  color: #ffffff;
}
.highlight .n, .highlight .py, .highlight .nx {
  color: #ffffff;
}
.highlight .ow {
  color: #f92672;
}
.highlight .nt {
  color: #f92672;
}
.highlight .k, .highlight .kv {
  color: #f92672;
}
.highlight .kn {
  color: #f92672;
}
.highlight .kp {
  color: #f92672;
}
.highlight .o {
  color: #f92672;
}
    </style>
    <link href="stylesheets/screen.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" media="print" />
      <script src="javascripts/all.js"></script>
  </head>

  <body class="index" data-languages="[&quot;javascript&quot;]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" alt="Navbar" />
      </span>
    </a>
    <div class="toc-wrapper">
      <img src="images/logo.png" class="logo" alt="Logo" />
        <div class="lang-selector">
              <a href="#" data-language-name="javascript">javascript</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <ul id="toc" class="toc-list-h1">
          <li>
            <a href="#overview" class="toc-h1 toc-link" data-title="Overview">Overview</a>
          </li>
          <li>
            <a href="#requirements" class="toc-h1 toc-link" data-title="Requirements">Requirements</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#integrated-partner-program" class="toc-h2 toc-link" data-title="Integrated Partner Program">Integrated Partner Program</a>
                  </li>
                  <li>
                    <a href="#bootstrapping-your-script" class="toc-h2 toc-link" data-title="Bootstrapping Your Script">Bootstrapping Your Script</a>
                  </li>
                  <li>
                    <a href="#technical-requirements" class="toc-h2 toc-link" data-title="Technical Requirements">Technical Requirements</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#events" class="toc-h1 toc-link" data-title="Events">Events</a>
          </li>
          <li>
            <a href="#event-types" class="toc-h1 toc-link" data-title="Event Types">Event Types</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#page-event" class="toc-h2 toc-link" data-title="Page Event">Page Event</a>
                  </li>
                  <li>
                    <a href="#dealership-info-event" class="toc-h2 toc-link" data-title="Dealership Info Event">Dealership Info Event</a>
                  </li>
                  <li>
                    <a href="#vehicle-event" class="toc-h2 toc-link" data-title="Vehicle Event">Vehicle Event</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#event-subscriptions" class="toc-h1 toc-link" data-title="Event Subscriptions">Event Subscriptions</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#page-load-v1" class="toc-h2 toc-link" data-title="Page Load V1">Page Load V1</a>
                  </li>
                  <li>
                    <a href="#dealership-info-v1" class="toc-h2 toc-link" data-title="Dealership Info V1">Dealership Info V1</a>
                  </li>
                  <li>
                    <a href="#vehicle-shown-v1" class="toc-h2 toc-link" data-title="Vehicle Shown V1">Vehicle Shown V1</a>
                  </li>
                  <li>
                    <a href="#vehicle-data-updated-v1" class="toc-h2 toc-link" data-title="Vehicle Data Updated V1">Vehicle Data Updated V1</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#api-methods" class="toc-h1 toc-link" data-title="API Methods">API Methods</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#subscribe-name-callback-event" class="toc-h2 toc-link" data-title="subscribe(name, callback(event))">subscribe(name, callback(event))</a>
                  </li>
                  <li>
                    <a href="#insert-name-callback-elem-meta" class="toc-h2 toc-link" data-title="insert(name, callback(elem, meta))">insert(name, callback(elem, meta))</a>
                  </li>
                  <li>
                    <a href="#create-type-data" class="toc-h2 toc-link" data-title="create(type, data)">create(type, data)</a>
                  </li>
                  <li>
                    <a href="#append-targetel-appendel" class="toc-h2 toc-link" data-title="append(targetEl, appendEl)">append(targetEl, appendEl)</a>
                  </li>
                  <li>
                    <a href="#loadjs-resourceurl" class="toc-h2 toc-link" data-title="loadJS(resourceUrl)">loadJS(resourceUrl)</a>
                  </li>
                  <li>
                    <a href="#loadcss-resourceurl" class="toc-h2 toc-link" data-title="loadCSS(resourceUrl)">loadCSS(resourceUrl)</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#insert-locations" class="toc-h1 toc-link" data-title="Insert Locations">Insert Locations</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#vehicle-media" class="toc-h2 toc-link" data-title="Vehicle Media">Vehicle Media</a>
                  </li>
                  <li>
                    <a href="#vehicle-badge" class="toc-h2 toc-link" data-title="Vehicle Badge">Vehicle Badge</a>
                  </li>
                  <li>
                    <a href="#vehicle-pricing" class="toc-h2 toc-link" data-title="Vehicle Pricing">Vehicle Pricing</a>
                  </li>
                  <li>
                    <a href="#vehicle-media-container" class="toc-h2 toc-link" data-title="Vehicle Media Container">Vehicle Media Container</a>
                  </li>
                  <li>
                    <a href="#primary-banner" class="toc-h2 toc-link" data-title="Primary Banner">Primary Banner</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#utility-methods" class="toc-h1 toc-link" data-title="Utility Methods">Utility Methods</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#api-utils-getattributeforvehicles-attribute" class="toc-h2 toc-link" data-title="API.utils.getAttributeForVehicles(attribute)">API.utils.getAttributeForVehicles(attribute)</a>
                  </li>
                  <li>
                    <a href="#api-utils-getconfig" class="toc-h2 toc-link" data-title="API.utils.getConfig()">API.utils.getConfig()</a>
                  </li>
                  <li>
                    <a href="#api-utils-getdealerdata" class="toc-h2 toc-link" data-title="API.utils.getDealerData()">API.utils.getDealerData()</a>
                  </li>
                  <li>
                    <a href="#api-utils-getjwtforvehicles" class="toc-h2 toc-link" data-title="API.utils.getJwtForVehicles()">API.utils.getJwtForVehicles()</a>
                  </li>
                  <li>
                    <a href="#api-utils-getpagedata" class="toc-h2 toc-link" data-title="API.utils.getPageData()">API.utils.getPageData()</a>
                  </li>
                  <li>
                    <a href="#api-utils-geturlparams" class="toc-h2 toc-link" data-title="API.utils.getUrlParams()">API.utils.getUrlParams()</a>
                  </li>
                  <li>
                    <a href="#api-utils-getvehicledata" class="toc-h2 toc-link" data-title="API.utils.getVehicleData()">API.utils.getVehicleData()</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#jwt-usage-documentation" class="toc-h1 toc-link" data-title="JWT Usage Documentation">JWT Usage Documentation</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#jwts" class="toc-h2 toc-link" data-title="JWTs">JWTs</a>
                  </li>
                  <li>
                    <a href="#jwks" class="toc-h2 toc-link" data-title="JWKs">JWKs</a>
                  </li>
                  <li>
                    <a href="#details" class="toc-h2 toc-link" data-title="Details">Details</a>
                  </li>
                  <li>
                    <a href="#example" class="toc-h2 toc-link" data-title="Example">Example</a>
                  </li>
                  <li>
                    <a href="#retrieving-a-jwt" class="toc-h2 toc-link" data-title="Retrieving a JWT">Retrieving a JWT</a>
                  </li>
                  <li>
                    <a href="#validating-the-jwt" class="toc-h2 toc-link" data-title="Validating the JWT">Validating the JWT</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#debugging-troubleshooting" class="toc-h1 toc-link" data-title="Debugging / Troubleshooting">Debugging / Troubleshooting</a>
          </li>
      </ul>
        <ul class="toc-footer">
            <li><a href='https://forms.dealer.com/integrated-partner-program.htm' target='_blank'>Sign Up for our Partner Program</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id='overview'>Overview</h1>
<p>Welcome to the Dealer.com Website Integration API! This API performs common actions on Dealer.com websites, such as loading scripts, adding CSS and inserting markup into common locations.</p>

<p>As this is a browser based API, it is written in JavaScript and has simple data contracts and interfaces.</p>

<aside class="notice">
This API is currently in development and is subject to evolution.
</aside>
<h1 id='requirements'>Requirements</h1><h2 id='integrated-partner-program'>Integrated Partner Program</h2>
<p>The use of this API requires that you are enrolled in our Integrated Partner Program. To find out more information or to enroll, please contact us at <a href="mailto:IntegratedPartners@coxautoinc.com"> IntegratedPartners@coxautoinc.com</a> or <a href="https://forms.dealer.com/integrated-partner-program.htm" target="_blank">fill out this form</a>.</p>

<p>Once enrolled, you will be provided with an integration key to use when making API calls.</p>
<h2 id='bootstrapping-your-script'>Bootstrapping Your Script</h2>
<p>Start by creating a simple JavaScript file that registers with the API and loads additional scripts or styling if necessary. You can leverage the available API capabilities in your script to place content on pages, or include existing integration code if necessary. Your script should eventually be hosted on a content delivery network such as Cloudfront or Akamai, but for development purposes you can host it anywhere.</p>

<p>When you begin development of your script, it&#39;s easy to test on any Dealer.com site to see how it will function. To accomplish that, follow these steps:</p>

<p><em>1.)</em> Load any Dealer.com site where you want to test your integration. If you don&#39;t already have a site in mind, a good one to start with is <a href="https://www.roimotors.com/" target="_blank">https://www.roimotors.com/</a>.</p>

<p><em>2.)</em> Open the developer tools in your browser and enter this code in the Console window:</p>
<pre class="highlight javascript tab-javascript"><code><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">WPAPI</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">API</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">WPAPI</span><span class="p">(</span><span class="s1">'test-integration'</span><span class="p">);</span>
  <span class="nx">API</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="s1">'https://www.yourdomain.com/your-javascript-file.js'</span><span class="p">);</span>
<span class="p">})(</span><span class="nb">window</span><span class="p">.</span><span class="nx">DDC</span><span class="p">.</span><span class="nx">API</span><span class="p">);</span>
</code></pre>
<p>This will set a cookie in your browser and instruct the site to load your defined script as if the integration was enabled. The code will only load for you in the current browser session so that you are able to iterate and test your code. When it is ready for activation on sites, we can set the integration up in our system and load your script for all users of the site(s) where it should be enabled. The set cookie expires when your browser session expires or you clear your browser cookies.</p>

<p><em>3.)</em> Add the <code>?_integrationMode=debug</code> URL parameter to the page you are testing to activate the cookied script for your page view. This will also provide an additional benefit of any <a href="#debugging">logged messages</a> in your script being output to the browser console for troubleshooting and debugging purposes.</p>

<p>Other methods:</p>

<ul>
<li><p>You can accomplish the same test setup as above by installing a browser extension such as <a href="https://chrome.google.com/webstore/detail/custom-javascript-for-web/poakhlngfciodnhlhhgnaaelnpjljija" target="_blank">Custom JavaScript for web sites</a> and loading your script using that mechanism. This will not require the <code>?_integrationMode=debug</code> parameter for the code to be executed on the site, however it&#39;s a good idea to use that parameter either way for <a href="#debugging-troubleshooting">better debugging output</a> in your browser console.</p></li>
<li><p>Alternate to both of the above methods, we can create a test site for you and specify the script to include on the site. This will make your integrated code available for all viewers of the test site which is useful in a setting where multiple stakeholders or developers want to see the integration in development or for testing purposes.</p></li>
</ul>

<p>Your code should be minimal and perform only actions necessary to bootstrap your integration on to the site. There is a simple subscribe example here, and you can see a more detailed <a href="#example-implementation">Example Implementation</a> for an idea of how to accomplish some common tasks.</p>
<h2 id='technical-requirements'>Technical Requirements</h2>
<blockquote>
<p>This is an example of an immediately executing function expression:</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">WPAPI</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">API</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">WPAPI</span><span class="p">();</span>
    <span class="c1">// API.subscribe(...);</span>
    <span class="c1">// Your code here</span>
<span class="p">})(</span><span class="nb">window</span><span class="p">.</span><span class="nx">DDC</span><span class="p">.</span><span class="nx">API</span><span class="p">);</span>
</code></pre>
<ul>
<li><p>Always ecapsulate your code in an immediately executing function expression to avoid polluting the global namespace. See sidebar for example of such a function.</p></li>
<li><p>Your bootstrap script and any other integration code or assets should be located on a highly available content delivery network and must work over an HTTPS connection.</p></li>
<li><p>All code should be minified and served using gzip or better compression.</p></li>
<li><p>Integrations should avoid loading excessive imagery, fonts and scripts. While some are often necessary, less is more and avoiding loading duplicate scripts will help reduce load time for your integration as well as improve overall website speed.</p></li>
<li><p>Please refrain from including large libraries such as jQuery or React, as both are already available on all pages of all of our sites.</p></li>
</ul>
<h1 id='events'>Events</h1>
<p>By subscribing to events we publish, you can easily obtain the data you need to integrate your solution into the website. These events provide data about the website your integration is loading on and the current page the user is viewing.</p>

<p>There are currently three types of events and each has a consistent data format.</p>
<h1 id='event-types'>Event Types</h1><h2 id='page-event'>Page Event</h2>
<blockquote>
<p>Example Payload</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="p">{</span>
  <span class="nl">accountId</span><span class="p">:</span> <span class="s1">'futuredemodealer'</span><span class="p">,</span>
  <span class="nx">siteId</span><span class="p">:</span> <span class="s1">'futuredemodealer'</span><span class="p">,</span>
  <span class="nx">defaultDomain</span><span class="p">:</span> <span class="s1">'www.roimotors.com'</span><span class="p">,</span>
  <span class="nx">indexPage</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
  <span class="nx">searchPage</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
  <span class="nx">detailPage</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
  <span class="nx">franchises</span><span class="p">:</span> <span class="p">[</span><span class="s1">'honda'</span><span class="p">],</span>
  <span class="nx">design</span><span class="p">:</span> <span class="p">{</span>
    <span class="nl">variationId</span><span class="p">:</span> <span class="s1">'v9_GLOBAL_0011_V2'</span><span class="p">,</span>
    <span class="nx">themekit</span><span class="p">:</span> <span class="s1">'BLUE_WHITE'</span>
  <span class="p">},</span>
  <span class="nx">pageName</span><span class="p">:</span> <span class="s1">'INDEX'</span><span class="p">,</span>
  <span class="nx">layoutType</span><span class="p">:</span> <span class="s1">'desktop'</span><span class="p">,</span>
  <span class="nx">locale</span><span class="p">:</span> <span class="s1">'en_US'</span>
<span class="p">}</span>
</code></pre>
<table><thead>
<tr>
<th>Field Key</th>
<th>Example Value</th>
<th>Field Format</th>
</tr>
</thead><tbody>
<tr>
<td><code>accountId</code></td>
<td><code>futuredemodealer</code></td>
<td><code>String</code></td>
</tr>
<tr>
<td><code>siteId</code></td>
<td><code>futuredemodealer</code></td>
<td><code>String</code></td>
</tr>
<tr>
<td><code>defaultDomain</code></td>
<td><code>www.roimotors.com</code></td>
<td><code>String</code></td>
</tr>
<tr>
<td><code>indexPage</code></td>
<td><code>true</code></td>
<td><code>Boolean</code></td>
</tr>
<tr>
<td><code>searchPage</code></td>
<td><code>false</code></td>
<td><code>Boolean</code></td>
</tr>
<tr>
<td><code>detailPage</code></td>
<td><code>false</code></td>
<td><code>Boolean</code></td>
</tr>
<tr>
<td><code>design</code></td>
<td><code>{variationId: &#39;v9_GLOBAL_0011_V2&#39;, themekit: &#39;BLUE_WHITE&#39;}</code></td>
<td><code>Object</code></td>
</tr>
<tr>
<td><code>franchises</code></td>
<td><code>[&#39;honda&#39;]</code></td>
<td><code>Array</code></td>
</tr>
<tr>
<td><code>pageName</code></td>
<td><code>INDEX</code></td>
<td><code>String</code></td>
</tr>
<tr>
<td><code>layoutType</code></td>
<td><code>desktop</code></td>
<td><code>String</code></td>
</tr>
<tr>
<td><code>locale</code></td>
<td><code>en_US</code></td>
<td><code>String</code></td>
</tr>
</tbody></table>
<h2 id='dealership-info-event'>Dealership Info Event</h2>
<blockquote>
<p>Example Payload</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="p">{</span>
  <span class="nl">dealershipName</span><span class="p">:</span> <span class="s1">'ROI Motors'</span><span class="p">,</span>
  <span class="nx">dealershipAddress1</span><span class="p">:</span> <span class="s1">'1 Howard Street'</span><span class="p">,</span>
  <span class="nx">dealershipAddress2</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span>
  <span class="nx">dealershipCity</span><span class="p">:</span> <span class="s1">'Burlington'</span><span class="p">,</span>
  <span class="nx">dealershipPostalCode</span><span class="p">:</span> <span class="s1">'05401'</span><span class="p">,</span>
  <span class="nx">dealershipStateProvince</span><span class="p">:</span> <span class="s1">'VT'</span><span class="p">,</span>
  <span class="nx">dealershipCountry</span><span class="p">:</span> <span class="s1">'US'</span>
<span class="p">}</span>
</code></pre>
<table><thead>
<tr>
<th>Field Key</th>
<th>Example Value</th>
<th>Field Format</th>
</tr>
</thead><tbody>
<tr>
<td><code>dealershipName</code></td>
<td><code>ROI Motors</code></td>
<td><code>String</code></td>
</tr>
<tr>
<td><code>dealershipAddress1</code></td>
<td><code>1 Howard Street</code></td>
<td><code>String</code></td>
</tr>
<tr>
<td><code>dealershipAddress2</code></td>
<td></td>
<td><code>String</code></td>
</tr>
<tr>
<td><code>dealershipCity</code></td>
<td><code>Burlington</code></td>
<td><code>String</code></td>
</tr>
<tr>
<td><code>dealershipPostalCode</code></td>
<td><code>05401</code></td>
<td><code>String</code></td>
</tr>
<tr>
<td><code>dealershipStateProvince</code></td>
<td><code>VT</code></td>
<td><code>String</code></td>
</tr>
<tr>
<td><code>dealershipCountry</code></td>
<td><code>US</code></td>
<td><code>String</code></td>
</tr>
</tbody></table>
<h2 id='vehicle-event'>Vehicle Event</h2>
<blockquote>
<p>Example Payload</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="p">{</span>
  <span class="nl">accountId</span><span class="p">:</span> <span class="s2">"futuredemodealer"</span><span class="p">,</span>
  <span class="nx">bodyStyle</span><span class="p">:</span> <span class="s2">"Sedan"</span><span class="p">,</span>
  <span class="nx">certified</span><span class="p">:</span> <span class="s2">"false"</span><span class="p">,</span>
  <span class="nx">cityFuelEconomy</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span>
  <span class="nx">classification</span><span class="p">:</span> <span class="s2">"primary"</span><span class="p">,</span>
  <span class="nx">doors</span><span class="p">:</span> <span class="s2">"4-door"</span><span class="p">,</span>
  <span class="nx">driveLine</span><span class="p">:</span> <span class="s2">"FWD"</span><span class="p">,</span>
  <span class="nx">engine</span><span class="p">:</span> <span class="s2">"I-4 cyl"</span><span class="p">,</span>
  <span class="nx">exteriorColor</span><span class="p">:</span> <span class="s2">"Platinum White Pearl"</span><span class="p">,</span>
  <span class="nx">finalPrice</span><span class="p">:</span> <span class="mi">28360</span><span class="p">,</span>
  <span class="nx">fuelType</span><span class="p">:</span> <span class="s2">"Regular Unleaded"</span><span class="p">,</span>
  <span class="nx">highwayFuelEconomy</span><span class="p">:</span> <span class="mi">38</span><span class="p">,</span>
  <span class="nx">interiorColor</span><span class="p">:</span> <span class="s2">"Black"</span><span class="p">,</span>
  <span class="nx">internetPrice</span><span class="p">:</span> <span class="mi">28360</span><span class="p">,</span>
  <span class="nx">inventoryType</span><span class="p">:</span> <span class="s2">"new"</span><span class="p">,</span>
  <span class="nx">make</span><span class="p">:</span> <span class="s2">"Honda"</span><span class="p">,</span>
  <span class="nx">model</span><span class="p">:</span> <span class="s2">"Accord"</span><span class="p">,</span>
  <span class="nx">msrp</span><span class="p">:</span> <span class="mi">28360</span><span class="p">,</span>
  <span class="nx">odometer</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
  <span class="nx">status</span><span class="p">:</span> <span class="s2">"Live"</span><span class="p">,</span>
  <span class="nx">stockNumber</span><span class="p">:</span> <span class="s2">"00180772"</span><span class="p">,</span>
  <span class="nx">transmission</span><span class="p">:</span> <span class="s2">"Variable"</span><span class="p">,</span>
  <span class="nx">trim</span><span class="p">:</span> <span class="s2">"EX"</span><span class="p">,</span>
  <span class="nx">uuid</span><span class="p">:</span> <span class="s2">"ab119e0e0a0a00f944d6f3031cd34854"</span><span class="p">,</span>
  <span class="nx">vin</span><span class="p">:</span> <span class="s2">"1HGCV1F42JA141468"</span><span class="p">,</span>
  <span class="nx">year</span><span class="p">:</span> <span class="mi">2018</span>
<span class="p">}</span>
</code></pre>
<table><thead>
<tr>
<th>Field Key</th>
<th>Example Value</th>
<th>Field Format</th>
</tr>
</thead><tbody>
<tr>
<td><code>accountId</code></td>
<td><code>futuredemodealer</code></td>
<td><code>String</code></td>
</tr>
<tr>
<td><code>bodyStyle</code></td>
<td><code>Sedan</code></td>
<td><code>String</code></td>
</tr>
<tr>
<td><code>certified</code></td>
<td><code>false</code></td>
<td><code>String</code></td>
</tr>
<tr>
<td><code>cityFuelEconomy</code></td>
<td><code>30</code></td>
<td><code>Integer</code></td>
</tr>
<tr>
<td><code>classification</code></td>
<td><code>primary</code></td>
<td><code>String</code></td>
</tr>
<tr>
<td><code>doors</code></td>
<td><code>4-door</code></td>
<td><code>String</code></td>
</tr>
<tr>
<td><code>driveLine</code></td>
<td><code>FWD</code></td>
<td><code>String</code></td>
</tr>
<tr>
<td><code>engine</code></td>
<td><code>I-4 cyl</code></td>
<td><code>String</code></td>
</tr>
<tr>
<td><code>exteriorColor</code></td>
<td><code>Platinum White Pearl</code></td>
<td><code>String</code></td>
</tr>
<tr>
<td><code>finalPrice</code></td>
<td><code>28360</code></td>
<td><code>Integer</code></td>
</tr>
<tr>
<td><code>fuelType</code></td>
<td><code>Regular Unleaded</code></td>
<td><code>String</code></td>
</tr>
<tr>
<td><code>highwayFuelEconomy</code></td>
<td><code>38</code></td>
<td><code>Integer</code></td>
</tr>
<tr>
<td><code>interiorColor</code></td>
<td><code>Black</code></td>
<td><code>String</code></td>
</tr>
<tr>
<td><code>internetPrice</code></td>
<td><code>28360</code></td>
<td><code>Integer</code></td>
</tr>
<tr>
<td><code>inventoryType</code></td>
<td><code>new</code></td>
<td><code>String</code></td>
</tr>
<tr>
<td><code>make</code></td>
<td><code>Honda</code></td>
<td><code>String</code></td>
</tr>
<tr>
<td><code>model</code></td>
<td><code>Accord</code></td>
<td><code>String</code></td>
</tr>
<tr>
<td><code>msrp</code></td>
<td><code>28360</code></td>
<td><code>Integer</code></td>
</tr>
<tr>
<td><code>odometer</code></td>
<td><code>5</code></td>
<td><code>Integer</code></td>
</tr>
<tr>
<td><code>status</code></td>
<td><code>Live</code></td>
<td><code>String</code></td>
</tr>
<tr>
<td><code>stockNumber</code></td>
<td><code>00180772</code></td>
<td><code>String</code></td>
</tr>
<tr>
<td><code>transmission</code></td>
<td><code>Variable</code></td>
<td><code>String</code></td>
</tr>
<tr>
<td><code>trim</code></td>
<td><code>EX</code></td>
<td><code>String</code></td>
</tr>
<tr>
<td><code>uuid</code></td>
<td><code>ab119e0e0a0a00f944d6f3031cd34854</code></td>
<td><code>String</code></td>
</tr>
<tr>
<td><code>vin</code></td>
<td><code>1HGCV1F42JA141468</code></td>
<td><code>String</code></td>
</tr>
<tr>
<td><code>year</code></td>
<td><code>2018</code></td>
<td><code>Integer</code></td>
</tr>
</tbody></table>
<h1 id='event-subscriptions'>Event Subscriptions</h1>
<p>To receive data for events, you must opt-in to event subscriptions. Each event is named and versioned to ensure it continues to operate in a consistent manner over time. As newer events supercede these, older events may be deprecated but will not be removed if still in use.</p>
<h2 id='page-load-v1'>Page Load V1</h2>
<blockquote>
<p>Usage</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">WPAPI</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">API</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">WPAPI</span><span class="p">();</span>
  <span class="nx">API</span><span class="p">.</span><span class="nx">subscribe</span><span class="p">(</span><span class="s1">'page-load-v1'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">ev</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">API</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">ev</span><span class="p">);</span>
  <span class="p">});</span>
<span class="p">})(</span><span class="nb">window</span><span class="p">.</span><span class="nx">DDC</span><span class="p">.</span><span class="nx">API</span><span class="p">);</span>

</code></pre>
<table><thead>
<tr>
<th>Parameter Name</th>
<th>Example Value</th>
<th>Parameter Type</th>
</tr>
</thead><tbody>
<tr>
<td><code>event-id</code></td>
<td><code>page-load-v1</code></td>
<td><code>String</code></td>
</tr>
<tr>
<td><code>callback</code></td>
<td><code>function(ev) { API.log(ev); }</code></td>
<td><code>function</code></td>
</tr>
</tbody></table>

<blockquote>
<p>This event passes the standard <a href="#page-event">Page Event</a> object to your callback function.</p>
</blockquote>

<p>The page load event is useful to determine the context of the current page. By mapping our siteId or domain field to a customer ID in your system, you can determine the site your code is executing on as well as relevant information about the current page type and user&#39;s device type. This approach eliminates the need for configuration in our system beyond simply enabling or disabling your integration for each site.</p>
<h2 id='dealership-info-v1'>Dealership Info V1</h2>
<blockquote>
<p>Usage</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">WPAPI</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">API</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">WPAPI</span><span class="p">();</span>
  <span class="nx">API</span><span class="p">.</span><span class="nx">subscribe</span><span class="p">(</span><span class="s1">'dealership-info-v1'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">ev</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">API</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">ev</span><span class="p">);</span>
  <span class="p">});</span>
<span class="p">})(</span><span class="nb">window</span><span class="p">.</span><span class="nx">DDC</span><span class="p">.</span><span class="nx">API</span><span class="p">);</span>

</code></pre>
<table><thead>
<tr>
<th>Parameter Name</th>
<th>Example Value</th>
<th>Parameter Type</th>
</tr>
</thead><tbody>
<tr>
<td><code>event-id</code></td>
<td><code>dealership-info-v1</code></td>
<td><code>String</code></td>
</tr>
<tr>
<td><code>callback</code></td>
<td><code>function(ev) { API.log(ev); }</code></td>
<td><code>function</code></td>
</tr>
</tbody></table>

<blockquote>
<p>This event passes the standard <a href="#dealership-info-event">Dealership Info Event</a> object to your callback function.</p>
</blockquote>

<p>The dealership info event is useful if you need to know the name and address of the dealership.</p>
<h2 id='vehicle-shown-v1'>Vehicle Shown V1</h2>
<blockquote>
<p>Usage</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">WPAPI</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">API</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">WPAPI</span><span class="p">();</span>
  <span class="nx">API</span><span class="p">.</span><span class="nx">subscribe</span><span class="p">(</span><span class="s1">'vehicle-shown-v1'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">ev</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">API</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">ev</span><span class="p">);</span>
  <span class="p">});</span>
<span class="p">})(</span><span class="nb">window</span><span class="p">.</span><span class="nx">DDC</span><span class="p">.</span><span class="nx">API</span><span class="p">);</span>
</code></pre>
<table><thead>
<tr>
<th>Parameter Name</th>
<th>Example Value</th>
<th>Parameter Type</th>
</tr>
</thead><tbody>
<tr>
<td><code>event-id</code></td>
<td><code>vehicle-shown-v1</code></td>
<td><code>String</code></td>
</tr>
<tr>
<td><code>callback</code></td>
<td><code>function(ev) { API.log(ev); }</code></td>
<td><code>function</code></td>
</tr>
</tbody></table>

<blockquote>
<p>This event passes the standard <a href="#vehicle-event">Vehicle Event</a> object to your callback function.</p>
</blockquote>

<p>This event is sent for each vehicle present on the current page. For search results pages, a dozen or more such events may be fired. In the future, dynamic in-page updates to vehicle results will cause potentially hundreds of events to be fired on a single page view as new vehicles are displayed.</p>

<p>On a vehicle deals page, a single event is fired because you are viewing a single vehicle. This is useful for capturing details about the vehicles that a user has viewed, or to take a particular action for a certain type or class of vehicles.</p>
<h2 id='vehicle-data-updated-v1'>Vehicle Data Updated V1</h2>
<blockquote>
<p>Usage</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">WPAPI</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">API</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">WPAPI</span><span class="p">();</span>
  <span class="nx">API</span><span class="p">.</span><span class="nx">subscribe</span><span class="p">(</span><span class="s1">'vehicle-data-updated-v1'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">ev</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">API</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">payload</span><span class="p">.</span><span class="nx">pageData</span><span class="p">);</span> <span class="c1">// Outputs the Page Data object to the console.</span>
    <span class="nx">API</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">payload</span><span class="p">.</span><span class="nx">vehicleData</span><span class="p">);</span> <span class="c1">// Outputs the updated Vehicle Data object to the console.</span>
  <span class="p">});</span>
<span class="p">})(</span><span class="nb">window</span><span class="p">.</span><span class="nx">DDC</span><span class="p">.</span><span class="nx">API</span><span class="p">);</span>
</code></pre>
<table><thead>
<tr>
<th>Parameter Name</th>
<th>Example Value</th>
<th>Parameter Type</th>
</tr>
</thead><tbody>
<tr>
<td><code>event-id</code></td>
<td><code>vehicle-data-updated-v1</code></td>
<td><code>String</code></td>
</tr>
<tr>
<td><code>callback</code></td>
<td><code>function(ev) { API.log(ev); }</code></td>
<td><code>function</code></td>
</tr>
</tbody></table>

<blockquote>
<p>This event passes the standard <a href="#page-event">Page Event</a> object to your callback function as well as the full array of <a href="#vehicle-event">Vehicle Event</a> data objects.</p>
</blockquote>

<p>This is useful for coding your application to work with our modern Search Results Page which is a dynamic single page application. When the list of vehicles is refreshed/updated, this event is fired with the Page and Vehicle payload of data for you to use as needed. Any subsequent methods/subscriptions/insertions can occur within this event, to ensure that when vehicles are updated your code immediately executes to decorate those vehicle cards with your content.</p>
<h1 id='api-methods'>API Methods</h1><h2 id='subscribe-name-callback-event'>subscribe(name, callback(event))</h2>
<blockquote>
<p>Usage</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">WPAPI</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">API</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">WPAPI</span><span class="p">();</span>
  <span class="nx">API</span><span class="p">.</span><span class="nx">subscribe</span><span class="p">(</span><span class="s1">'event-name-and-version'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">API</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">event</span><span class="p">);</span>
  <span class="p">});</span>
<span class="p">})(</span><span class="nb">window</span><span class="p">.</span><span class="nx">DDC</span><span class="p">.</span><span class="nx">API</span><span class="p">);</span>
</code></pre>
<p>Please see the <a href="#event-subscriptions">specific event documentation</a> for more detail on the available events and the data payload sent to your callback function.</p>
<h2 id='insert-name-callback-elem-meta'>insert(name, callback(elem, meta))</h2>
<blockquote>
<p>Usage</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">WPAPI</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">API</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">WPAPI</span><span class="p">();</span>
  <span class="nx">API</span><span class="p">.</span><span class="nx">insert</span><span class="p">(</span><span class="s1">'location-name'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">elem</span><span class="p">,</span> <span class="nx">meta</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">API</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">elem</span><span class="p">);</span> <span class="c1">// The DOM element where markup may be inserted.</span>
    <span class="nx">API</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">meta</span><span class="p">);</span> <span class="c1">// The payload object for the current insertion point.</span>
  <span class="p">});</span>
<span class="p">})(</span><span class="nb">window</span><span class="p">.</span><span class="nx">DDC</span><span class="p">.</span><span class="nx">API</span><span class="p">);</span>
</code></pre>
<p>The insert method allows you to append markup into specific set locations on some pages. These locations are commonly used areas you may want to target. If you find there are target areas outside of the currently available options, please let us know your use case and we will work to accommodate your needs.</p>

<p>When activated, <code>insert</code> will call a callback function you define with the <code>elem</code> and <code>meta</code> parameters.</p>

<table><thead>
<tr>
<th>Field Name</th>
<th>Purpose</th>
<th>Field Format</th>
</tr>
</thead><tbody>
<tr>
<td><code>elem</code></td>
<td>The DOM element where the markup should be inserted.</td>
<td>Element</td>
</tr>
<tr>
<td><code>meta</code></td>
<td>The payload object for the current insertion point.</td>
<td>Object</td>
</tr>
</tbody></table>
<h2 id='create-type-data'>create(type, data)</h2>
<blockquote>
<p>Create a Button</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">WPAPI</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">API</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">WPAPI</span><span class="p">();</span>
  <span class="kd">var</span> <span class="nx">button</span> <span class="o">=</span> <span class="nx">API</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="s1">'button'</span><span class="p">,</span> <span class="p">{</span>
    <span class="na">text</span><span class="p">:</span> <span class="s1">'Visit Google'</span><span class="p">,</span>
    <span class="na">src</span><span class="p">:</span> <span class="s1">'https://www.google.com/'</span><span class="p">,</span>
    <span class="na">classes</span><span class="p">:</span> <span class="s1">'btn btn-primary'</span><span class="p">,</span>
    <span class="na">style</span><span class="p">:</span> <span class="s1">'border: 2px solid #c00'</span><span class="p">,</span>
    <span class="na">attributes</span><span class="p">:</span> <span class="p">{</span>
      <span class="s1">'target'</span><span class="p">:</span> <span class="s1">'_blank'</span>
    <span class="p">}</span>
  <span class="p">});</span>
  <span class="nx">API</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">button</span><span class="p">);</span>
  <span class="c1">// The above outputs: &lt;a href="https://www.google.com/" class="btn btn-primary" style="border: 2px solid rgb(204, 0, 0);" target="_blank"&gt;Visit Google&lt;/a&gt;</span>
<span class="p">})(</span><span class="nb">window</span><span class="p">.</span><span class="nx">DDC</span><span class="p">.</span><span class="nx">API</span><span class="p">);</span>
</code></pre>
<p>The create method can be used to generate markup which adheres to our standard practices. This allows you to simply &quot;create a button&quot;, for example, without having to know the inner workings of how buttons should be created on different types of sites.</p>

<p>Currently only the &quot;button&quot; type is supported, however other types will soon be added. Please let us know if there are particular types of elements you want to create so we can work to incorporate your feedback into this API.</p>
<h2 id='append-targetel-appendel'>append(targetEl, appendEl)</h2>
<blockquote>
<p>Usage</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">WPAPI</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">API</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">WPAPI</span><span class="p">();</span>
  <span class="nx">API</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="nx">targetEl</span><span class="p">,</span> <span class="nx">appendEl</span><span class="p">);</span>
<span class="p">})(</span><span class="nb">window</span><span class="p">.</span><span class="nx">DDC</span><span class="p">.</span><span class="nx">API</span><span class="p">);</span>
</code></pre>
<blockquote>
<p>For example, used in conjunction with the <code>insert</code> and the <code>create</code> methods your code might look similar to this:</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">WPAPI</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">API</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">WPAPI</span><span class="p">();</span>
  <span class="nx">API</span><span class="p">.</span><span class="nx">insert</span><span class="p">(</span><span class="s1">'target-location-name'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">elem</span><span class="p">,</span> <span class="nx">meta</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">lowPrice</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">round</span><span class="p">(</span><span class="nx">meta</span><span class="p">.</span><span class="nx">finalPrice</span> <span class="o">-</span> <span class="mi">1000</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">highPrice</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">round</span><span class="p">(</span><span class="nx">meta</span><span class="p">.</span><span class="nx">finalPrice</span> <span class="o">+</span> <span class="mi">1000</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">button</span> <span class="o">=</span> <span class="nx">API</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="s1">'button'</span><span class="p">,</span> <span class="p">{</span>
      <span class="na">text</span><span class="p">:</span> <span class="s1">'Search This Price Range'</span><span class="p">,</span>
      <span class="na">src</span><span class="p">:</span> <span class="s1">'/new-inventory/index.htm?internetPrice='</span> <span class="o">+</span> <span class="nx">lowPrice</span><span class="p">.</span><span class="nx">toString</span><span class="p">()</span> <span class="o">+</span> <span class="s1">'-'</span> <span class="o">+</span> <span class="nx">highPrice</span><span class="p">.</span><span class="nx">toString</span><span class="p">(),</span>
      <span class="na">classes</span><span class="p">:</span> <span class="s1">'btn btn-primary'</span><span class="p">,</span>
      <span class="na">style</span><span class="p">:</span> <span class="s1">'margin-top: 12px;'</span><span class="p">,</span>
      <span class="na">attributes</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">'target'</span><span class="p">:</span> <span class="s1">'_blank'</span>
      <span class="p">}</span>
    <span class="p">})</span>
    <span class="nx">API</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="nx">elem</span><span class="p">,</span> <span class="nx">button</span><span class="p">);</span>
  <span class="p">});</span>
<span class="p">})(</span><span class="nb">window</span><span class="p">.</span><span class="nx">DDC</span><span class="p">.</span><span class="nx">API</span><span class="p">);</span>
</code></pre>
<p>When calling the insert method, the goal is to insert some markup into a location on the page. Once you have constructed the element(s) you wish to insert, you may call the <code>append</code> method to complete the process.</p>
<h2 id='loadjs-resourceurl'>loadJS(resourceUrl)</h2>
<blockquote>
<p>Usage</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">WPAPI</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">API</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">WPAPI</span><span class="p">();</span>
  <span class="c1">// Loads a JavaScript file</span>
  <span class="nx">API</span><span class="p">.</span><span class="nx">loadJS</span><span class="p">(</span><span class="s1">'https://www.company.com/script.js'</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="c1">// Code to execute after your JavaScript file has loaded.</span>
    <span class="p">});</span>
<span class="p">})(</span><span class="nb">window</span><span class="p">.</span><span class="nx">DDC</span><span class="p">.</span><span class="nx">API</span><span class="p">);</span>
</code></pre>
<p>The loadJS method is a simple way to include additional JavaScript files required for your integration. The method returns a JavaScript Promise which you can use to know when file loading is complete, to then run any necessary initialization functions, etc.</p>
<h2 id='loadcss-resourceurl'>loadCSS(resourceUrl)</h2>
<blockquote>
<p>Usage</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">WPAPI</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">API</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">WPAPI</span><span class="p">();</span>
  <span class="c1">// Loads a CSS stylesheet</span>
  <span class="nx">API</span><span class="p">.</span><span class="nx">loadCSS</span><span class="p">(</span><span class="s1">'https://www.company.com/integration.css'</span><span class="p">);</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="c1">// Code to execute after your stylesheet has loaded.</span>
    <span class="p">});</span>
<span class="p">})(</span><span class="nb">window</span><span class="p">.</span><span class="nx">DDC</span><span class="p">.</span><span class="nx">API</span><span class="p">);</span>
</code></pre>
<p>The loadCSS method is a simple way to include an additional CSS stylesheet file required for your integration. The method returns a JavaScript Promise which you can use to know when stylesheet loading is complete, to then insert markup that depends on that styling to avoid display a flash of unstyled content.</p>
<h1 id='insert-locations'>Insert Locations</h1>
<p>Insert locations are areas of pages where you can safely insert markup. These exist in commonly used areas, such as below vehicle pricing on search and detail pages. This section details the current available locations. Please let us know if there are other locations you want to target beyond those listed here.</p>

<p>See the <a href="#ddc-api-insert-key-name-callback-elem-meta">insert documentation</a> for more details on the insert method.</p>
<h2 id='vehicle-media'>Vehicle Media</h2>
<blockquote>
<p>Usage:</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">WPAPI</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">API</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">WPAPI</span><span class="p">();</span>
  <span class="nx">API</span><span class="p">.</span><span class="nx">insert</span><span class="p">(</span><span class="s1">'vehicle-media'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">elem</span><span class="p">,</span> <span class="nx">meta</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// This element is positioned below the vehicle image area on vehicle search pages.</span>
  <span class="p">});</span>
<span class="p">})(</span><span class="nb">window</span><span class="p">.</span><span class="nx">DDC</span><span class="p">.</span><span class="nx">API</span><span class="p">);</span>
</code></pre>
<blockquote>
<p>Example Implementation:</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">WPAPI</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">API</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">WPAPI</span><span class="p">();</span>
  <span class="nx">API</span><span class="p">.</span><span class="nx">subscribe</span><span class="p">(</span><span class="s1">'page-load-v1'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">ev</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">ev</span><span class="p">.</span><span class="nx">payload</span><span class="p">.</span><span class="nx">searchPage</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">API</span><span class="p">.</span><span class="nx">insert</span><span class="p">(</span><span class="s1">'vehicle-media'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">elem</span><span class="p">,</span> <span class="nx">meta</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">button</span> <span class="o">=</span> <span class="nx">API</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="s1">'button'</span><span class="p">,</span> <span class="p">{</span>
          <span class="na">text</span><span class="p">:</span> <span class="s1">'Watch Video'</span><span class="p">,</span>
          <span class="na">src</span><span class="p">:</span> <span class="s1">'https://www.providerdomain.com/path/video-player.html?vin='</span> <span class="o">+</span> <span class="nx">meta</span><span class="p">.</span><span class="nx">vin</span><span class="p">,</span>
          <span class="na">classes</span><span class="p">:</span> <span class="s1">'btn btn-primary dialog'</span><span class="p">,</span>
          <span class="na">style</span><span class="p">:</span> <span class="s1">'margin-top: 12px;'</span><span class="p">,</span>
          <span class="na">attributes</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">'target'</span><span class="p">:</span> <span class="s1">'_blank'</span>
          <span class="p">}</span>
        <span class="p">});</span>
        <span class="nx">API</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="nx">elem</span><span class="p">,</span> <span class="nx">button</span><span class="p">);</span>
      <span class="p">});</span>
    <span class="p">}</span>
  <span class="p">});</span>
<span class="p">})(</span><span class="nb">window</span><span class="p">.</span><span class="nx">DDC</span><span class="p">.</span><span class="nx">API</span><span class="p">);</span>
</code></pre>
<p>This element is positioned below the vehicle image area on vehicle search pages.</p>
<h2 id='vehicle-badge'>Vehicle Badge</h2>
<blockquote>
<p>Usage:</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">WPAPI</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">API</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">WPAPI</span><span class="p">();</span>
  <span class="nx">API</span><span class="p">.</span><span class="nx">insert</span><span class="p">(</span><span class="s1">'vehicle-badge'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">elem</span><span class="p">,</span> <span class="nx">meta</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// This element is positioned below the vehicle tech specs area on vehicle search and detail pages.</span>
  <span class="p">});</span>
<span class="p">})(</span><span class="nb">window</span><span class="p">.</span><span class="nx">DDC</span><span class="p">.</span><span class="nx">API</span><span class="p">);</span>
</code></pre>
<blockquote>
<p>Example Implementation:</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">WPAPI</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">API</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">WPAPI</span><span class="p">();</span>
  <span class="nx">API</span><span class="p">.</span><span class="nx">subscribe</span><span class="p">(</span><span class="s1">'page-load-v1'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">ev</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">ev</span><span class="p">.</span><span class="nx">payload</span><span class="p">.</span><span class="nx">searchPage</span> <span class="o">||</span> <span class="nx">ev</span><span class="p">.</span><span class="nx">payload</span><span class="p">.</span><span class="nx">detailPage</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">API</span><span class="p">.</span><span class="nx">insert</span><span class="p">(</span><span class="s1">'vehicle-badge'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">elem</span><span class="p">,</span> <span class="nx">meta</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">meta</span><span class="p">.</span><span class="nx">inventoryType</span> <span class="o">!==</span> <span class="s1">'used'</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">return</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="kd">var</span> <span class="nx">img</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">'img'</span><span class="p">),</span>
          <span class="nx">a</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">'a'</span><span class="p">);</span>

        <span class="nx">img</span><span class="p">.</span><span class="nx">src</span> <span class="o">=</span> <span class="s1">'https://static.dealer.com/v8/global/images/franchise/white/logo-certified-carfax-free-lrg.png'</span><span class="p">;</span>
        <span class="nx">img</span><span class="p">.</span><span class="nx">alt</span> <span class="o">=</span> <span class="s1">'Carfax Free Report'</span><span class="p">;</span>

        <span class="nx">a</span><span class="p">.</span><span class="nx">href</span> <span class="o">=</span> <span class="s1">'https://www.carfax.com/VehicleHistory/p/Report.cfx?partner=DLR_3&amp;vin='</span> <span class="o">+</span> <span class="nx">meta</span><span class="p">.</span><span class="nx">vin</span><span class="p">;</span>
        <span class="nx">a</span><span class="p">.</span><span class="nx">target</span> <span class="o">=</span> <span class="s1">'_blank'</span><span class="p">;</span>
        <span class="nx">a</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="nx">img</span><span class="p">.</span><span class="nx">outerHTML</span><span class="p">;</span>

        <span class="nx">API</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="nx">elem</span><span class="p">,</span> <span class="nx">a</span><span class="p">);</span>
      <span class="p">});</span>
    <span class="p">}</span>
  <span class="p">});</span>
<span class="p">})(</span><span class="nb">window</span><span class="p">.</span><span class="nx">DDC</span><span class="p">.</span><span class="nx">API</span><span class="p">);</span>
</code></pre>
<p>This element is positioned below the vehicle tech specs area on vehicle search and detail pages.</p>
<h2 id='vehicle-pricing'>Vehicle Pricing</h2>
<blockquote>
<p>Usage:</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">WPAPI</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">API</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">WPAPI</span><span class="p">();</span>
  <span class="nx">API</span><span class="p">.</span><span class="nx">insert</span><span class="p">(</span><span class="s1">'vehicle-pricing'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">elem</span><span class="p">,</span> <span class="nx">meta</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// This element is positioned below the vehicle pricing area on vehicle search and detail pages.</span>
  <span class="p">});</span>
<span class="p">})(</span><span class="nb">window</span><span class="p">.</span><span class="nx">DDC</span><span class="p">.</span><span class="nx">API</span><span class="p">);</span>
</code></pre>
<blockquote>
<p>Example Implementation:</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">WPAPI</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">API</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">WPAPI</span><span class="p">();</span>
  <span class="nx">API</span><span class="p">.</span><span class="nx">subscribe</span><span class="p">(</span><span class="s1">'page-load-v1'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">ev</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Only execute the code on search results and vehicle details pages.</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">ev</span><span class="p">.</span><span class="nx">payload</span><span class="p">.</span><span class="nx">searchPage</span> <span class="o">||</span> <span class="nx">ev</span><span class="p">.</span><span class="nx">payload</span><span class="p">.</span><span class="nx">detailPage</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">API</span><span class="p">.</span><span class="nx">insert</span><span class="p">(</span><span class="s1">'vehicle-pricing'</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">elem</span><span class="p">,</span> <span class="nx">meta</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">lowPrice</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">round</span><span class="p">(</span><span class="nx">meta</span><span class="p">.</span><span class="nx">finalPrice</span> <span class="o">-</span> <span class="mi">1000</span><span class="p">);</span>
        <span class="kd">var</span> <span class="nx">highPrice</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">round</span><span class="p">(</span><span class="nx">meta</span><span class="p">.</span><span class="nx">finalPrice</span> <span class="o">+</span> <span class="mi">1000</span><span class="p">);</span>
        <span class="kd">var</span> <span class="nx">button</span> <span class="o">=</span> <span class="nx">API</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="s1">'button'</span><span class="p">,</span> <span class="p">{</span>
          <span class="na">text</span><span class="p">:</span> <span class="s1">'Search This Price Range'</span><span class="p">,</span>
          <span class="na">src</span><span class="p">:</span> <span class="s1">'/'</span> <span class="o">+</span> <span class="nx">meta</span><span class="p">.</span><span class="nx">inventoryType</span> <span class="o">+</span> <span class="s1">'-inventory/index.htm?internetPrice='</span> <span class="o">+</span> <span class="nx">lowPrice</span><span class="p">.</span><span class="nx">toString</span><span class="p">()</span> <span class="o">+</span> <span class="s1">'-'</span> <span class="o">+</span> <span class="nx">highPrice</span><span class="p">.</span><span class="nx">toString</span><span class="p">(),</span>
          <span class="na">classes</span><span class="p">:</span> <span class="s1">'btn btn-primary'</span><span class="p">,</span>
          <span class="na">style</span><span class="p">:</span> <span class="s1">'margin-top: 12px;'</span>
        <span class="p">})</span>
        <span class="nx">API</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="nx">elem</span><span class="p">,</span> <span class="nx">button</span><span class="p">);</span>
      <span class="p">});</span>
    <span class="p">}</span>
  <span class="p">});</span>
<span class="p">})(</span><span class="nb">window</span><span class="p">.</span><span class="nx">DDC</span><span class="p">.</span><span class="nx">API</span><span class="p">);</span>
</code></pre>
<p>This element is positioned below the vehicle pricing area on vehicle search and detail pages.</p>
<h2 id='vehicle-media-container'>Vehicle Media Container</h2>
<blockquote>
<p>Usage:</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">WPAPI</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">API</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">WPAPI</span><span class="p">();</span>
  <span class="nx">API</span><span class="p">.</span><span class="nx">insert</span><span class="p">(</span><span class="s1">'vehicle-media-container'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">elem</span><span class="p">,</span> <span class="nx">meta</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// This element is the media gallery container on vehicle deals pages.</span>
    <span class="c1">// Injecting into this location will replace the media gallery with the elements you insert.</span>
  <span class="p">});</span>
<span class="p">})(</span><span class="nb">window</span><span class="p">.</span><span class="nx">DDC</span><span class="p">.</span><span class="nx">API</span><span class="p">);</span>
</code></pre>
<blockquote>
<p>Example Implementation:</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">WPAPI</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">API</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">WPAPI</span><span class="p">();</span>
  <span class="nx">API</span><span class="p">.</span><span class="nx">subscribe</span><span class="p">(</span><span class="s1">'page-load-v1'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">ev</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">ev</span><span class="p">.</span><span class="nx">payload</span><span class="p">.</span><span class="nx">detailPage</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">API</span><span class="p">.</span><span class="nx">insert</span><span class="p">(</span><span class="s1">'vehicle-media-container'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">elem</span><span class="p">,</span> <span class="nx">meta</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">containerEl</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">'div'</span><span class="p">);</span>
        <span class="nx">containerEl</span><span class="p">.</span><span class="nx">style</span> <span class="o">=</span> <span class="s1">'background-color: #ff0000; font-size: 30px; width: 100%; height: 540px; margin: 0 auto; padding: 100px; text-align: center;'</span><span class="p">;</span>
        <span class="nx">containerEl</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="s1">'Your media container goes here.'</span><span class="p">;</span>
        <span class="nx">API</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="nx">elem</span><span class="p">,</span> <span class="nx">containerEl</span><span class="p">);</span>
      <span class="p">});</span>
    <span class="p">}</span>
  <span class="p">});</span>
<span class="p">})(</span><span class="nb">window</span><span class="p">.</span><span class="nx">DDC</span><span class="p">.</span><span class="nx">API</span><span class="p">);</span>
</code></pre>
<p>This element is the media gallery container on vehicle deals pages. Injecting into this location will replace the media gallery with the elements you insert.</p>
<h2 id='primary-banner'>Primary Banner</h2>
<blockquote>
<p>Usage:</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">WPAPI</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">API</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">WPAPI</span><span class="p">();</span>
  <span class="nx">API</span><span class="p">.</span><span class="nx">insert</span><span class="p">(</span><span class="s1">'primary-banner'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">elem</span><span class="p">,</span> <span class="nx">meta</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// This element is typically positioned in a prominent location above the vehicle listings on the Search Results Page.</span>
    <span class="c1">// On the Details page, it is near the top of the vehicle information, below the media gallery.</span>
  <span class="p">});</span>
<span class="p">})(</span><span class="nb">window</span><span class="p">.</span><span class="nx">DDC</span><span class="p">.</span><span class="nx">API</span><span class="p">);</span>
</code></pre>
<blockquote>
<p>Example Implementation:</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">WPAPI</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">API</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">WPAPI</span><span class="p">();</span>
  <span class="nx">API</span><span class="p">.</span><span class="nx">subscribe</span><span class="p">(</span><span class="s1">'page-load-v1'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">ev</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">ev</span><span class="p">.</span><span class="nx">payload</span><span class="p">.</span><span class="nx">searchPage</span> <span class="o">||</span> <span class="nx">ev</span><span class="p">.</span><span class="nx">payload</span><span class="p">.</span><span class="nx">detailPage</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">API</span><span class="p">.</span><span class="nx">insert</span><span class="p">(</span><span class="s1">'primary-banner'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">elem</span><span class="p">,</span> <span class="nx">meta</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">img</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">'img'</span><span class="p">),</span>
          <span class="nx">a</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">'a'</span><span class="p">);</span>

        <span class="nx">img</span><span class="p">.</span><span class="nx">src</span> <span class="o">=</span> <span class="s1">'https://pictures.dealer.com/d/ddcdemohonda/0217/15bd9bd8ecf0b2a292a91cecb08c595bx.jpg'</span><span class="p">;</span>
        <span class="nx">img</span><span class="p">.</span><span class="nx">alt</span> <span class="o">=</span> <span class="s1">'New 2015 Honda Pilot'</span><span class="p">;</span>
        <span class="nx">img</span><span class="p">.</span><span class="nx">title</span> <span class="o">=</span> <span class="s1">'New 2015 Honda Pilot'</span><span class="p">;</span>

        <span class="nx">a</span><span class="p">.</span><span class="nx">href</span> <span class="o">=</span> <span class="s1">'/specials/new.htm'</span><span class="p">;</span>
        <span class="nx">a</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="nx">img</span><span class="p">.</span><span class="nx">outerHTML</span><span class="p">;</span>

        <span class="nx">API</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="nx">elem</span><span class="p">,</span> <span class="nx">a</span><span class="p">);</span>
      <span class="p">});</span>
    <span class="p">}</span>
  <span class="p">});</span>
<span class="p">})(</span><span class="nb">window</span><span class="p">.</span><span class="nx">DDC</span><span class="p">.</span><span class="nx">API</span><span class="p">);</span>
</code></pre>
<p>This element is positioned in a prominent location above the vehicle listings on the Search Results Page.</p>

<p>On the Details page, it is positioned at the top of the vehicle information, below the media gallery.</p>

<p>You can target either the listings or details page by first subscribing to the page-load-v1 event, and using the event values of <code>payload.searchPage</code> and <code>payload.detailPage</code> to check the page type.</p>
<h1 id='utility-methods'>Utility Methods</h1>
<p>In addition to the event based system for working with sites, some utility methods are available to directly access data needed to make decisions in your code. Rather than waiting for a particular event to fire, you can query the information directly at any point in your code to ensure it is in context at the point where you need it. All utility methods return a JavaScript Promise so you can ensure the data is available before proceeding with the rest of your code.</p>
<h2 id='api-utils-getattributeforvehicles-attribute'>API.utils.getAttributeForVehicles(attribute)</h2>
<blockquote>
<p>Usage:</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">WPAPI</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">API</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">WPAPI</span><span class="p">();</span>
  <span class="nx">API</span><span class="p">.</span><span class="nx">subscribe</span><span class="p">(</span><span class="s1">'vehicle-data-updated-v1'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>

    <span class="nx">API</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">payload</span><span class="p">.</span><span class="nx">pageData</span><span class="p">);</span> <span class="c1">// Logs the Page Data object</span>
    <span class="nx">API</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">payload</span><span class="p">.</span><span class="nx">vehicleData</span><span class="p">);</span> <span class="c1">// Logs the updated Vehicle Data object</span>

    <span class="nx">API</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">getAttributeForVehicles</span><span class="p">(</span><span class="s1">'vin'</span><span class="p">).</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">vins</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// With the updated list of VINs, you could query your service</span>
      <span class="c1">// to determine which VINs are supported by your service before</span>
      <span class="c1">// placing relevant content such as buttons or iframes.</span>

      <span class="c1">// Code to query your service goes here.</span>

      <span class="c1">// Output an array of VINs for vehicles currently displayed on the page.</span>
      <span class="nx">API</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">vins</span><span class="p">);</span>
    <span class="p">});</span>
  <span class="p">})</span>
<span class="p">})(</span><span class="nb">window</span><span class="p">.</span><span class="nx">DDC</span><span class="p">.</span><span class="nx">API</span><span class="p">);</span>
</code></pre>
<p>This can be used to obtain an array of attributes for the currently displayed vehicles on a page. For example, passing the attribute &#39;finalPrice&#39; would return an array of all of the final prices on the page. Passing &#39;vin&#39; would return an array of vehicle vins. You can pass any of the attributes that are present on the <a href="#vehicle-event">Vehicle Event object</a> and have this return an array.</p>
<h2 id='api-utils-getconfig'>API.utils.getConfig()</h2>
<blockquote>
<p>Usage:</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">WPAPI</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">API</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">WPAPI</span><span class="p">(</span><span class="s1">'test-integration'</span><span class="p">);</span>
  <span class="nx">API</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">getConfig</span><span class="p">().</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">config</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Output the configuration object for your integration (if defined).</span>
    <span class="nx">API</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">config</span><span class="p">);</span>
  <span class="p">});</span>
<span class="p">})(</span><span class="nb">window</span><span class="p">.</span><span class="nx">DDC</span><span class="p">.</span><span class="nx">API</span><span class="p">);</span>
</code></pre>
<p>This fetches a JavaScript object of your integration&#39;s configuration for the current website and page. Not all integrations have configuration options in our system (aside from enabled/disabled), but if your integration does, you can use this to obtain the configuration data.</p>
<h2 id='api-utils-getdealerdata'>API.utils.getDealerData()</h2>
<blockquote>
<p>Usage:</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">WPAPI</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">API</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">WPAPI</span><span class="p">();</span>
  <span class="nx">API</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">getDealerData</span><span class="p">().</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">dealerData</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Logs the Dealership Info Event object for the current website.</span>
    <span class="nx">API</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">dealerData</span><span class="p">);</span>
  <span class="p">});</span>
<span class="p">})(</span><span class="nb">window</span><span class="p">.</span><span class="nx">DDC</span><span class="p">.</span><span class="nx">API</span><span class="p">);</span>
</code></pre>
<p>This fetches the <a href="#dealership-info-event">Dealership Info Event object</a> for the current website.</p>
<h2 id='api-utils-getjwtforvehicles'>API.utils.getJwtForVehicles()</h2>
<blockquote>
<p>Usage:</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">WPAPI</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">API</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">WPAPI</span><span class="p">();</span>
  <span class="nx">API</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">getJwtForVehicles</span><span class="p">().</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">jwtObject</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">API</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">jwtObject</span><span class="p">);</span>
    <span class="c1">// Returns a data structure like this:</span>
    <span class="c1">// {</span>
    <span class="c1">//   vins: ["1HGCV1F51LA013850", "1HGCV1F16LA029720", "1HGCV1F32LA011829"], // Array</span>
    <span class="c1">//   jwt: "eyJraWQiOiIya0k0XzIyZoLUUi...KpSUf6vJ8b9Z1NDRcIgv0GrZoiqPhTunw" // String</span>
    <span class="c1">// }</span>
  <span class="p">});</span>
<span class="p">})(</span><span class="nb">window</span><span class="p">.</span><span class="nx">DDC</span><span class="p">.</span><span class="nx">API</span><span class="p">);</span>
</code></pre>
<p>This fetches an object containing the array of VINs on the current page and a corresponding Java Web Token which can be used to secure/verify the request from our site to your service. This tool offers the capability for you to validate that the request for content from your service originated from our platform and enables you to determine whether or not the content should be served up. For more details regarding how to use this with your service, please refer to the <a href="#jwt-usage-documentation">JWT usage documentation</a>.</p>
<h2 id='api-utils-getpagedata'>API.utils.getPageData()</h2>
<blockquote>
<p>Usage:</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">WPAPI</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">API</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">WPAPI</span><span class="p">();</span>
  <span class="nx">API</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">getPageData</span><span class="p">().</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">pageData</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Outputs the Page Data Object for the current page.</span>
    <span class="nx">API</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">pageData</span><span class="p">);</span>
  <span class="p">});</span>
<span class="p">})(</span><span class="nb">window</span><span class="p">.</span><span class="nx">DDC</span><span class="p">.</span><span class="nx">API</span><span class="p">);</span>
</code></pre>
<p>This fetches the <a href="#page-event">Page Event object</a> for the current website and page.</p>
<h2 id='api-utils-geturlparams'>API.utils.getUrlParams()</h2>
<p>NOTE: This method does not return a promise as the URL Params are immediately available and do not require Promise behavior.</p>

<blockquote>
<p>Usage:</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">WPAPI</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">API</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">WPAPI</span><span class="p">();</span>
  <span class="kd">var</span> <span class="nx">urlParams</span> <span class="o">=</span> <span class="nx">API</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">getUrlParams</span><span class="p">();</span>
  <span class="nx">API</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">urlParams</span><span class="p">);</span> <span class="c1">// Logs the configuration object for your integration (if there is one).</span>
<span class="p">})(</span><span class="nb">window</span><span class="p">.</span><span class="nx">DDC</span><span class="p">.</span><span class="nx">API</span><span class="p">);</span>
</code></pre><h2 id='api-utils-getvehicledata'>API.utils.getVehicleData()</h2>
<blockquote>
<p>Usage:</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">WPAPI</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">API</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">WPAPI</span><span class="p">();</span>
  <span class="kd">var</span> <span class="nx">config</span> <span class="o">=</span> <span class="nx">API</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">getVehicleData</span><span class="p">().</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">vehicleData</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Outputs the current set of vehicle data.</span>
    <span class="nx">API</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">vehicleData</span><span class="p">);</span>
  <span class="p">});</span>
<span class="p">})(</span><span class="nb">window</span><span class="p">.</span><span class="nx">DDC</span><span class="p">.</span><span class="nx">API</span><span class="p">);</span>
</code></pre><h1 id='jwt-usage-documentation'>JWT Usage Documentation</h1>
<p>This API provides a method for loosely coupled content delivery authentication, enabling you to only provide content for valid requests from Dealer.com sites.</p>

<p>We have <a href="downloads/ddc-ipp-auth-demo-master.zip">a sample application</a> to demonstrate how to consume Dealer.com&#39;s Integrated Partner Program <a href="https://tools.ietf.org/html/rfc7517">JWKs</a>, <a href="https://tools.ietf.org/html/rfc7519">JWTs</a>, and <a href="https://tools.ietf.org/html/rfc7515">JWSs</a>.  How to pronounce <code>JWSs</code> is left as an exercise for the reader.</p>
<h2 id='jwts'>JWTs</h2>
<p>JWTs are used to claim that, at the time the token is issued, Dealer.com rendered a webpage containing specific vehicles, on a specific domain, for a specific account.</p>

<p>An off-platform vendor can validate this token and use that result to decide whether or not to provide paid content.</p>

<p>This claim is then signed with a rotating RSA private key, and the public keys are published on a <code>*.dealer.com</code> domain with HTTPS.</p>

<p>Successful validation of a JWT with one of our public keys ensures that the claims were not tampered with.</p>

<p>The consumer of a JWT is responsible for validating the signature, and can make their own decision about whether or not to honor the token.  Dealer.com provides an <a href="https://tools.ietf.org/html/rfc7519#section-4.1.6"><code>iat</code> (Issued At)</a> claim, but does <em>not</em> provide an <a href="https://tools.ietf.org/html/rfc7519#section-4.1.4"><code>exp</code> (Expiration Time)</a> claim.  This means the consumer is free to (and should) define their own limits on token freshness.  An implicit expiry is reached when Dealer.com is no longer publishing the public key of the keypair that a particular JWT is signed with.</p>
<h2 id='jwks'>JWKs</h2>
<p>JWKs are published on a Dealer.com domain with HTTPS, which prevents a malicious actor from distributing public keys that would validate JWT signatures not generated by Dealer.com.</p>

<p>JWK public keys are guaranteed to be published well before the corresponding private key is used for generating JWTs.</p>

<p>This means consumers polling for public keys will always be able to validate the signature on a new, valid JWT.</p>

<p>JWKs are hosted on Dealer.com&#39;s Content Delivery Network, and therefore are highly available to consumers.</p>

<p>Consumers <em>SHOULD</em> poll and cache JWKs for a short period of time.
Consumers <em>SHOULD NOT</em> cache or store keys for an extended period of time to ensure invalidated/expired keys are removed in a timely manner.</p>

<p>JWKs are published as a <a href="https://tools.ietf.org/html/rfc7517#section-5">JWK Set</a>, and each JWT signature contains the <a href="https://tools.ietf.org/html/rfc7515#section-4.1.4"><code>kid</code> (Key Id)</a> of the JWK used to verify the signature.</p>
<h2 id='details'>Details</h2>
<p>The details in this document are <em>not necessarily final</em> and are subject to change with notice.</p>

<p>At the time of writing:</p>

<p><strong>JWK URL</strong>: https://api.web.dealer.com/ipp/keys/jwks.json</p>

<p><strong>JWK Algorith</strong>: 2048-bit RSA</p>

<p><strong>JWK Usage</strong>:
- Private Key: Used to sign JWTs for up to 1 day
- Public Key: Published 1 day before Private Key is used, removed from publishing after 30 days</p>

<p><strong>JWK Consumer Cache Duration</strong>: 0-15 minutes, recommend 1 minute.</p>

<p><strong>JWA</strong>: <a href="https://tools.ietf.org/html/rfc7518#section-7.1.2">RS256</a></p>

<p><strong>JWT Claims</strong>:
- <code>iss</code>: (Issuer) Dealer.com
- <code>aud</code>: (Audience) IPP
- <code>sub</code>: (Subject) The Dealer.com account ID
- <code>domain</code>: The public hostname associated with the Dealer.com account ID
- <code>VINs</code>: A list of VINs that Dealer.com believes the given subject has access to</p>
<h2 id='example'>Example</h2>
<p>The <a href="downloads/ddc-ipp-auth-demo-master.zip">provided example</a> is a spring-boot application that polls the JWK url to fetch public keys as they&#39;re published.  It has a single endpoint (<code>/jwt/validate/{jwt}</code>) that accepts a JWT as a path parameter and validates the signature and audience.</p>
<h2 id='retrieving-a-jwt'>Retrieving a JWT</h2>
<p>A test JWT can be generated for any dealer.com site by calling <code>&lt;domain&gt;/api/jwt/vehicles?vins=</code> and providing a list of VINs that are valid for that site.</p>

<p>A full example for <code>roimotors.com</code> would be:</p>
<pre class="highlight plaintext"><code>curl -Lv https://roimotors.com/api/ipp/jwt/vehicles?vins=1HGCV1F46LA013527,1HGCV1F51LA013850,1HGCV1F52LA011170,1HGCV1F57LA003078
</code></pre>
<p>Decode the token at https://jwt.io/ to check that all of the requested VINs were returned.
If any VINs are missing, that means that Dealer.com believes the given account doesn&#39;t have access to display that inventory.</p>

<p>The Web Integration API provides <a href="#api-utils-getjwtforvehicles">a convenience method</a> for obtaining the valid VINs and JWT for the current page where your code is executing. This accomplishes the step above and provides you with the JWT which can be passed to your system through a URL parameter on a request which then can be validated on your service with the following validation step.</p>
<h2 id='validating-the-jwt'>Validating the JWT</h2>
<p>Once you have a valid JWT, you can validate it with the sample application. The JWT is guaranteed to be url-safe.</p>
<pre class="highlight plaintext"><code>curl -v localhost:8080/jwt/validate/&lt;jwt&gt;
</code></pre><h1 id='debugging-troubleshooting'>Debugging / Troubleshooting</h1>
<blockquote>
<p>Example Implementation:</p>
</blockquote>
<pre class="highlight javascript tab-javascript"><code><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">WPAPI</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">API</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">WPAPI</span><span class="p">();</span>
  <span class="nx">API</span><span class="p">.</span><span class="nx">subscribe</span><span class="p">(</span><span class="s1">'page-load-v1'</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">ev</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">ev</span><span class="p">.</span><span class="nx">payload</span><span class="p">.</span><span class="nx">searchPage</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">API</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'My integration has loaded and this is a search results page.'</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">});</span>
<span class="p">})(</span><span class="nb">window</span><span class="p">.</span><span class="nx">DDC</span><span class="p">.</span><span class="nx">API</span><span class="p">);</span>
</code></pre>
<p>When developing an integration, it&#39;s helpful to know if the API is doing what you expect and if your code is running successfully. The API intentionally suppresses most errors in regular use cases, however you can opt to view the error messages and API events by adding the following URL parameter to any page of any Dealer.com web site:</p>

<p><code>?_integrationMode=debug</code></p>

<p>This will allow the API to output some log messages to your browser&#39;s console regarding the actions it is taking. Additionally, you can instrument your own integration with log messages to validate that the expected code is being executed and desired code paths are being followed.</p>

<p>To log messages from within your integration code, simply use the <code>API.log</code> method the same way you would use <code>console.log</code>. Those messages will be output to your console when the above URL parameter is present and will be suppressed when it is not.</p>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="javascript">javascript</a>
          </div>
      </div>
    </div>
  </body>
</html>
